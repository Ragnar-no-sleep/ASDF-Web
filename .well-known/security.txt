# Security Policy for ASDF Web
# See https://securitytxt.org/ for more information
# Version: 2.0.0 (Updated 2026-01-03)

# Contact information for security researchers
Contact: mailto:security@alonisthe.dev
Contact: https://github.com/Ragnar-no-sleep/ASDF-Web/security/advisories/new

# Security policy document
Policy: https://github.com/Ragnar-no-sleep/ASDF-Web/security

# Preferred languages for security reports
Preferred-Languages: en, fr

# Canonical URL for this security.txt file
Canonical: https://asdf-web.onrender.com/.well-known/security.txt

# Acknowledgments (Hall of Fame)
Acknowledgments: https://github.com/Ragnar-no-sleep/ASDF-Web/blob/main/SECURITY.md

# Expiration date (update annually)
Expires: 2027-01-03T23:59:59.000Z

# ============================================
# Security Measures Implemented (v2.0.0)
# ============================================
#
# Authentication & Session:
# - httpOnly cookies for JWT storage (XSS protection)
# - SameSite=strict cookie attribute (CSRF protection)
# - Secure cookie flag in production (HTTPS only)
# - Cookie path restriction (/api)
# - credentials: 'include' for cross-origin auth
# - Token revocation/blacklist mechanism for logout
#
# API Security (Phase 3-4):
# - JWT authentication with HS256 algorithm enforcement
# - Request timeouts (30s) to prevent DoS
# - Webhook payload size limits (1MB)
# - Multi-tier rate limiting (general, auth, purchase, wallet, game)
# - ALLOWED_ORIGINS enforcement in production (fail-fast)
# - Content-Type validation middleware (415 for non-JSON)
# - Request ID tracking (X-Request-ID header)
# - Query parameter sanitization (control chars, length limits)
# - Request signing with HMAC and nonce replay protection
# - Admin wallet format validation at startup
# - Mutex-protected challenge/nonce cleanup
# - Webhook secret fail-secure in production
# - Input validation helpers (validateId, validateName, validateWalletAddress)
#
# Web Security (CSP Enhanced):
# - Content Security Policy with strict directives
# - scriptSrc: self + CDNs (unpkg, cdnjs) with SRI validation
# - connectSrc: restricted to known API endpoints
# - objectSrc: none (blocks plugins)
# - blockAllMixedContent in production
# - HTTPS enforcement with HSTS (1 year, preload)
# - XSS protection via textContent (not innerHTML for user data)
# - DOMPurify integration for user-generated content
# - Subresource Integrity (SRI) on all external scripts
#
# Client Security:
# - Server-managed JWT via httpOnly cookie
# - Authentication state tracking (server is source of truth)
# - Automatic session invalidation on 401
# - Rate limiting on client-side API calls
# - SecurityUtils module (escapeHtml, sanitizeText, validateNumber)
#
# Data Protection:
# - isHolder and balance NEVER trusted from localStorage
# - On-chain verification required for holder status
# - State integrity hashing for tamper detection
# - Schema validation for stored data
# - Truncated wallet addresses in logs (privacy)
#
# Error Handling:
# - sanitizeError() for production error messages
# - Global error handler for unhandled exceptions
# - Process-level handlers (uncaughtException, unhandledRejection)
# - Context-aware error logging
#
# Infrastructure:
# - Environment variable validation at startup
# - Production fail-fast for missing critical configs
# - Graceful shutdown handling
# - 404 handler for unknown API routes
# - Comprehensive .gitignore (secrets, internal docs)
#
# ============================================
# Security Audit Summary (2026-01-03)
# ============================================
#
# Phase 1: Critical vulnerability fixes (10 issues)
# Phase 2: Hardening (token revocation, mutex, httpOnly cookies)
# Phase 3: Audit fixes (PRIORITY_FEE, webhook validation, input sanitization)
# Phase 4: CSP enhancement, request validation middleware, error review
#
# VERIFIED SECURE:
# - No sensitive files tracked in git
# - All external scripts have SRI hashes
# - Logs use truncated wallet addresses
# - CSRF protection via SameSite=strict
#
# SECURITY BY DESIGN PRINCIPLES:
# - Defense in depth (multiple layers)
# - Fail-secure defaults
# - Least privilege
# - Input validation at boundaries
# - Server-side authority for sensitive operations