# Security Policy for ASDF Web
# See https://securitytxt.org/ for more information
# Version: 1.9.0 (Updated 2026-01-03)

# Contact information for security researchers
Contact: mailto:security@alonisthe.dev
Contact: https://github.com/Ragnar-no-sleep/ASDF-Web/security/advisories/new

# Security policy document
Policy: https://github.com/Ragnar-no-sleep/ASDF-Web/security

# Preferred languages for security reports
Preferred-Languages: en, fr

# Canonical URL for this security.txt file
Canonical: https://asdf-web.onrender.com/.well-known/security.txt

# Acknowledgments (Hall of Fame)
Acknowledgments: https://github.com/Ragnar-no-sleep/ASDF-Web/blob/main/SECURITY.md

# Expiration date (update annually)
Expires: 2027-01-03T23:59:59.000Z

# ============================================
# Security Measures Implemented (v1.9.0)
# ============================================
#
# Authentication & Session (NEW in v1.9.0):
# - httpOnly cookies for JWT storage (XSS protection)
# - SameSite=strict cookie attribute (CSRF protection)
# - Secure cookie flag in production (HTTPS only)
# - Cookie path restriction (/api)
# - credentials: 'include' for cross-origin auth
# - Legacy Authorization header fallback (migration period)
#
# API Security:
# - JWT authentication with HS256 algorithm enforcement
# - Token revocation/blacklist mechanism for logout
# - Request timeouts (30s) to prevent DoS
# - Webhook payload size limits (1MB)
# - Rate limiting per endpoint with health endpoint protection
# - ALLOWED_ORIGINS enforcement in production (fail-fast)
# - Content-Type validation middleware
# - Request signing with HMAC and nonce replay protection
# - Admin wallet format validation at startup
# - Mutex-protected challenge/nonce cleanup
# - Global error handlers for uncaught exceptions
# - Process-level error handlers (uncaughtException, unhandledRejection)
# - CORS with credentials support for cookie auth
#
# Web Security:
# - Content Security Policy (CSP) with strict directives
# - HTTPS enforcement with HSTS (1 year, preload)
# - XSS protection via DOM API (no innerHTML with user data)
# - DOMPurify integration for user-generated content
# - Static file serving restrictions (.env, .json, etc. blocked)
# - CSRF token validation with fallback mechanisms
# - JWT expiration check before API requests
#
# Client Security:
# - Server-managed JWT via httpOnly cookie
# - Authentication state tracking (server is source of truth)
# - Automatic session invalidation on 401
# - Rate limiting on client-side API calls
#
# Data Protection:
# - isHolder and balance NEVER trusted from localStorage
# - On-chain verification required for holder status
# - State integrity hashing for tamper detection
# - Schema validation for stored data
#
# Infrastructure:
# - Environment variable validation at startup
# - Production fail-fast for missing critical configs
# - Graceful shutdown handling
# - 404 handler for unknown API routes
# - Comprehensive .gitignore (secrets, internal docs)
#
# ============================================
# Comprehensive Audit Findings (2026-01-03)
# ============================================
#
# VERIFIED SECURE:
# - No sensitive files tracked in git
# - .env files properly excluded
# - Internal documentation patterns excluded
# - api/.env.example intentionally tracked (template only)
#
# SECURITY BY DESIGN PRINCIPLES APPLIED:
# - Defense in depth (multiple layers)
# - Fail-secure defaults
# - Least privilege
# - Input validation at boundaries
# - Server-side authority for sensitive operations